# 基于嵌入式的智能码表设计

## 引言

随着移动设备技术的日益发展，嵌入式设备愈加受到重视。可穿戴设备具有各种类的产品形态，可佩戴于人体的多个部位，比如服饰、手表、眼镜、手环、饰品等。而可穿戴电子外套也正在研发，随着日后研发的深入，嵌入到人体皮肤内的电子文身、佩戴的眼镜都有机会用到可穿戴技术。得益于各种新技术的发展，可穿戴设备将愈发不被人感知，将以更加自然的状态进行数据搜集，为用户更好的提供服务。

码表作为骑行爱好者必备的装备之一，根据功能的多少分化出不同的产品，而不同产品定位之间的巨大差价导致了大多数人无法享受到功能相对丰富的码表，本文档旨在探讨一种组成简单，成本低廉的码表新方案。

## 1. 系统设计

本系统包含硬件工作系统与软件功能系统，其中硬件系统包含MCU(STM32) 主控模块、电源供电充电模块、GPS定位模块等。软件系统则包含LVGL模拟以及和上层安卓的软件系统。图1 所示为系统组成框图。

![系统组成框架](https://s1.plumeta.com/i/2022/09/19/fqvlif.png)

## 2. 功能实现

- 1.支持速度、距离、时间、卡路里、航向显示
- 2.拥有**离线地图**，支持显示实时位置，支持缩放
- 3.支持计步
- 4.支持经纬度、海拔显示
- 5.支持RTC自动根据GPS校准
- 6.支持记录轨迹，可导出GPX格式的文件
- 7.支持掉电自动保存数据(JSON格式文件)
- 8.四小时续航 (持续工作，始终亮屏)
- 9.支持在PC模拟器模拟，脱离硬件调试(配置为**Release x86**)
- 10.支持显示实时轨迹

## 3. 硬件设计

硬件框图如图 2 所示。硬件组成框图主要介绍了智能码表的硬件系统基本构成，包括基于 Cortex_M3 架构的意法半导体的 CPU 芯片 AT32F435CGU7 的 STM32 最小系统、电源模块、显示屏、地磁计以及GPS模块。

![硬件框架图](https://s1.plumeta.com/i/2022/09/19/fv9gqc.png)

## 4 嵌入式软件设计

软件设计包含了LVGL模拟器中LVGL V8操作系统的移植、应用程序的界面设计、STM32 嵌入式软件设计以及安卓 App 的相关设计等内容。其中还有系统运行流程、计步器算法等部分。嵌入式软件框图如图 3 所示。

![嵌入式软件设计图](https://s1.plumeta.com/i/2022/09/19/j397ot.png)